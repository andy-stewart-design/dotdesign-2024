<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v4.2.7"><title>Andy Stewart | Product Design + Creative Technology</title><link rel="stylesheet" href="/_astro/index.yFzCqPa7.css" />
<style>.yIDclW_alert{background:var(--color-primary);color:var(--neutral-900);padding-inline:var(--px-app);padding-block:var(--space-xs)}.yIDclW_alert p{font-size:var(--font-sm);text-align:center}.yIDclW_alert b{font-weight:var(--font-semibold);color:var(--black)}.IGVfLW_footer section{padding-inline:var(--px-app);max-width:72ch;margin-inline-start:auto;margin-inline-end:auto}.IGVfLW_footer section ul{border-top:1px solid var(--border-subtle);justify-content:center;gap:var(--space-lg);padding-block:var(--space-xl);display:flex}.IGVfLW_footer section a{text-decoration:none}.IGVfLW_footer section a span{color:var(--color-primary)}
.Wxe8HW_header{gap:4rem;display:grid}.Wxe8HW_header section{gap:1.5em;display:grid}.Wxe8HW_header h1{font-variant-numeric:slashed-zero;margin-block-end:-.25rem}.Wxe8HW_header p{font-size:var(--font-xl);color:var(--text-subtle)}.Wxe8HW_header a{font-size:var(--font-sm);font-weight:var(--font-medium);width:max-content;text-decoration:none}.Wxe8HW_header a span{color:var(--color-primary)}.Wxe8HW_metadata{align-items:center;gap:var(--space-md);font-size:var(--font-sm);font-weight:var(--font-medium);color:var(--text-subtle);line-height:var(--leading-sm);display:flex}.Wxe8HW_metadata time{font-size:var(--font-sm);line-height:var(--leading-sm);color:var(--neutral-500)}.Wxe8HW_metadata ul{gap:var(--space-sm);font-size:var(--font-xs);text-transform:capitalize;display:flex}.Wxe8HW_metadata ul li{padding-inline:var(--space-sm);border:1px solid;border-radius:100vmax;margin:0;padding-block-start:var(--space-xs);padding-block-end:calc(var(--space-xs) + 1px);list-style-type:none}
</style><style>.ob5p7q_wrapper{--input-height:1.5rem;position:relative}.ob5p7q_video{object-fit:cover}.ob5p7q_play{color:#fff;font-variant-numeric:tabular-nums;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);cursor:pointer;opacity:var(--opacity);background:#0009;border:1px solid #fff5;border-radius:100vmax;align-items:center;gap:16px;padding-block-start:16px;padding-block-end:16px;padding-inline-start:20px;padding-inline-end:20px;font-size:.875rem;font-weight:500;line-height:1;transition:opacity .15s ease-out;display:flex;position:absolute;bottom:24px;left:24px;box-shadow:0 -1px 3px #00000005,0 1px 2px -5px #00000008,0 2px 5px -5px #0000000d,0 4px 12px -5px #0000000f,0 12px 15px -5px #00000014}.ob5p7q_wrapper:hover .ob5p7q_play{opacity:1}video:focus-visible+.ob5p7q_play{opacity:1}.ob5p7q_play:-webkit-any(:hover,:focus-visible){opacity:1}.ob5p7q_play:-moz-any(:hover,:focus-visible){opacity:1}.ob5p7q_play:is(:hover,:focus-visible){opacity:1}.ob5p7q_progress{-webkit-appearance:none;-moz-appearance:none;appearance:none;height:var(--input-height);cursor:pointer;opacity:var(--opacity);background:0 0;width:100%;margin:0;transition:opacity .15s ease-out;position:absolute;top:0;left:0}.ob5p7q_progress::-webkit-slider-runnable-track{height:var(--input-height);background:linear-gradient(to right,var(--neutral-50)0%,var(--neutral-50)var(--progress),#00000080 var(--progress));transform-origin:top;transition:scale .15s ease-out .2s;scale:1 .166667}.ob5p7q_progress::-moz-range-track{height:var(--input-height);background:linear-gradient(to right,var(--neutral-50)0%,var(--neutral-50)var(--progress),transparent var(--progress));transform-origin:top;transition:scale .15s ease-out .2s;scale:1 .25}.ob5p7q_progress::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;height:var(--input-height);width:var(--input-height);background-color:#0000}.ob5p7q_progress::-moz-range-thumb{height:var(--input-height);width:var(--input-height);background-color:#0000}.ob5p7q_progress:hover::-webkit-slider-runnable-track{scale:1 .666667}.ob5p7q_progress:focus-visible::-webkit-slider-runnable-track{scale:1}.ob5p7q_wrapper:hover .ob5p7q_progress{opacity:1}video:focus-visible~.ob5p7q_progress{opacity:1}.ob5p7q_progress:-webkit-any(:hover,:focus-visible){opacity:1}.ob5p7q_progress:-moz-any(:hover,:focus-visible){opacity:1}.ob5p7q_progress:is(:hover,:focus-visible){opacity:1}
</style><style>.Nz59Dq_hidden{clip:rect(0,0,0,0);white-space:nowrap;border-width:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}
</style></head> <body> <!-- <Nav /> -->  <div class="yIDclW_alert"><p><b>Bless the mess!</b> This site is being built as you read it. LMK if something looks weird.</p></div> <article class="prose mx-auto px-app py-xl"> <header class="Wxe8HW_header"><a href="/posts"><span>←</span> All Posts</a><section><h1>AllStock 2.0 for Figma</h1><p>Highlights from the new version of my image search plugin</p><div class="Wxe8HW_metadata"><time>January 30, 2024</time><ul role="list"><li>figma</li><li>development</li></ul></div></section></header> <hr> <main> <p>A little Figma plugin I released last year recently passed 2K users. Not bad for a project that I published and then promptly never mentioned publicly.</p>
<p>It’s called <a href="https://www.figma.com/community/plugin/1235675201027690011/allstock">AllStock</a>, and it’s a one-stop shop for finding and using high-quality images directly inside of Figma. It allows users to browse popular free photo libraries like Unsplash, Pexels, and Pixabay all at the same time without needing to leave their design file.</p>
<p><img src="/_astro/AllStock-Cover-5x3.blEiIoPT_1veLEN.webp" alt="AllStock promo image" width="2400" height="1440"></p>
<p>The project started as a learning exercise to explore Figma’s plugin API. Unexpectedly, a nontrivial number of people have found it useful, so over the holiday break I decided to dive back in and rebuild it into a more proper product.</p>
<p>In the end, I overhauled every part of the codebase from scratch, from the interface to the APIs. Here are some of my favorite details from the project:</p>
<style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><script>window._$HY||(e=>{let t=e=>e&&e.hasAttribute&&(e.hasAttribute("data-hk")?e:t(e.host&&e.host.nodeType?e.host:e.parentNode));["click", "input"].forEach((o=>document.addEventListener(o,(o=>{let a=o.composedPath&&o.composedPath()[0]||o.target,s=t(a);s&&!e.completed.has(s)&&e.events.push([s,o])}))))})(_$HY={events:[],completed:new WeakSet,r:{},fe(){}});</script><!--xs--><astro-island uid="Z5HVAC" data-solid-render-id="s0" component-url="/_astro/Video.5QkUCIKI.js" component-export="default" renderer-url="/_astro/client.Lmnjjtyy.js" props="{&quot;src&quot;:[0,&quot;https://res.cloudinary.com/andystewartdesign/video/upload/v1707428210/work/figma/allstock-demo-4x3.mp4&quot;],&quot;poster&quot;:[0,&quot;https://res.cloudinary.com/andystewartdesign/image/upload/v1707428288/work/figma/allstock-demo-4x3-poster.jpg&quot;],&quot;autoplay&quot;:[0,true],&quot;muted&quot;:[0,true],&quot;loop&quot;:[0,true],&quot;width&quot;:[0,&quot;1600&quot;],&quot;height&quot;:[0,&quot;1200&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Video&quot;,&quot;value&quot;:true}" await-children=""><div data-hk="s00-0-0-0" class="ob5p7q_wrapper" style="--progress:NaN%"><video autoplay muted loop poster="https://res.cloudinary.com/andystewartdesign/image/upload/v1707428288/work/figma/allstock-demo-4x3-poster.jpg" tabindex="0" width="1600" height="1200" class="ob5p7q_video"><source src="https://res.cloudinary.com/andystewartdesign/video/upload/v1707428210/work/figma/allstock-demo-4x3.mp4"></video><button class="ob5p7q_play" style="--opacity:0" aria-label="Play"><!--$--><svg data-hk="s00-0-0-1-0" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M4,2L8,2C9.105,2 10,2.895 10,4L10,20C10,21.105 9.105,22 8,22L4,22C2.895,22 2,21.105 2,20L2,4C2,2.895 2.895,2 4,2ZM16,2L20,2C21.105,2 22,2.895 22,4L22,20C22,21.105 21.105,22 20,22L16,22C14.895,22 14,21.105 14,20L14,4C14,2.895 14.895,2 16,2Z" fill="currentColor"></path></svg><!--/--><!--$--><span data-hk="s00-0-0-2-0-0" class="Nz59Dq_hidden " >Pause</span><!--/--><span><!--$-->0:00<!--/--> / <!--$-->0:00<!--/--></span></button><input class="ob5p7q_progress" style="--opacity:0" value="0" min="0" max="0" step="0.01" type="range" aria-label="Current Time" aria-valuetext="0:00"></div><!--astro:end--></astro-island>
<h2 id="easier-access">Easier Access</h2>
<p>You can now launch the plugin directly from Figma’s quick actions menu (Figma’s native launcher—think spotlight or Raycast). In your Figma design file, simply type <code>command + /</code> on Mac to access the quick actions menu, and then enter “allstock” and your search query to get started. I’m also now keeping the plugin open after you import an image, based on user feedback, in case you want to import multiple images in a single session (you’re welcome, Kyle).</p>
<p><img src="/_astro/allstock-quickactions.Yxl04DE8_25gIny.webp" alt="The Figma quick actions menu being used to search a plugin called AllStock for images of rainbows" width="2400" height="1200"></p>
<h2 id="more-secure">More Secure</h2>
<p>Figma plugins are strictly frontend, client side applications, meaning there’s no straightforward way to protect secret keys. In the original build, I did my best to obfuscate all requisite API keys, but it was admittedly a bit hacky. This time around, I’m proxying all requests through hand-rolled Vercel edge functions (using the web framework Hono JS), meaning the API keys never have to touch the client side code. (And don’t worry—I got new keys, too.)</p>
<p><img src="/_astro/allstock-performance._ouaHTDD_Z2kgAsH.webp" alt="A visualization showing data being sent from an image service through Vercel to Figma in order to protect the API keys needed to access the data" width="4800" height="2640"></p>
<h2 id="more-performant">More Performant</h2>
<p>In the first version of the plugin, I imported images directly from the relevant image service. It was efficient to build, but the size of the raw images ended up being a liability, slowing down—and occasionally even crashing—the plugin. Now, I’m using ImageKit under the hood to optimize images before importing them into the file. As a side effect, this also affords users more control over the output size and quality of photos.</p>
<p><img src="/_astro/allstock-imagequality.YfR4Vmf8_1BCAw6.webp" alt="Detail view of the AllStock filter menu showing the export image quality and size inputs" width="2400" height="1200"></p>
<h2 id="streamlined-interface">Streamlined Interface</h2>
<p>If I’m honest, a lot of the “back end” work described above is in service of my desire to design front end interfaces. The new interface simplifies the search process by getting lesser-used options out of the way and putting the search input and service select boxes front and center. Additional filters can be accessed in an offscreen dialog as needed. Other quality of life features, such as previewing larger versions of images before importing them, and browsing results in a custom masonry-style layout, help make the experience feel more polished and complete.</p>
<p><img src="/_astro/allstock-interface.8mZdM3Mg_Z2tGHLR.webp" alt="Detail view of the AllStock search bar. The value of search input is &#34;portrait,&#34; and the the user is hovering over a button with the Unsplash logo" width="2400" height="1200"></p>
<p>I love side projects like this, where a seemingly small and straightforward idea ends up leading you in several unexpected directions. Looking back, I already had about 75-80% of the knowledge that I would need to accomplish my goal—meaning I had enough new concepts to explore to keep things interesting, but not so many that I got lost or overwhelmed.</p>
<p>If you want to try it out for yourself, the plugin is available now <a href="https://www.figma.com/community/plugin/1235675201027690011">wherever you get your plugins</a> (i.e. the Figma community).</p> </main> </article> <footer class="IGVfLW_footer"><section><ul role="list"><!--$--><a href="https://andystewart.design" target="_blank"><!--$-->Portfolio<!--/--> <span>↗</span></a><a href="https://codepen.io/andystewartdesign" target="_blank"><!--$-->LinkedIn<!--/--> <span>↗</span></a><a href="https://github.com/andy-stewart-design" target="_blank"><!--$-->Github<!--/--> <span>↗</span></a><a href="https://codepen.io/andystewartdesign" target="_blank"><!--$-->Codepen<!--/--> <span>↗</span></a><!--/--><li></li></ul></section></footer>  </body></html>